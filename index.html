<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Dashâ€‘Synced Generative Audio Circles</title>
    <style>
      :root {
        color-scheme: dark;
      }
      html,
      body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        background: #111;
        overflow: hidden;
        font-family: sans-serif;
      }
      svg {
        display: block;
        width: 100%;
        height: 100%;
        cursor: crosshair;
      }
      .ghost {
        fill: none;
        stroke: rgba(255, 255, 255, 0.15);
        stroke-width: 1.5;
      }
      .spinner {
        fill: none;
        stroke-width: 8;
        transform-box: fill-box;
        transform-origin: center;
        /* subtle transition for non-transform visual emphasis (avoid using transform here so spin animation isn't overridden) */
        transition:
          stroke-width 120ms ease-out,
          filter 120ms ease-out;
      }
      .spinner.emphasized {
        /* visual emphasis without touching transform so the spin animation keeps rotating */
        stroke-width: 12;
      }

      /* Glow ring that visually echoes a note being played.
               The glow is implemented via an SVG filter (defined in the canvas)
               and a short "playing" animation that briefly increases opacity/scale. */
      .glow-ring {
        fill: none;
        stroke-opacity: 0.9;
        stroke-width: 14;
        transform-box: fill-box;
        transform-origin: center;
        pointer-events: none; /* purely decorative */
        opacity: 0;
        transition:
          opacity 160ms ease-out,
          transform 180ms cubic-bezier(0.22, 0.9, 0.35, 1);
        /* the filter reference is set on the element via the SVG `filter` attribute */
      }

      /* When a circle is in the "playing" state we flash the glow ring */
      .glow-ring.playing {
        opacity: 1;
        transform: scale(1.08);
      }

      /* provide a slightly more pronounced outer halo on play */
      .glow-ring.playing {
        stroke-opacity: 0.95;
      }
      @keyframes spin {
        to {
          transform: rotate(-360deg);
        }
      }

      #clearBtn {
        position: absolute;
        top: 20px;
        right: 20px;
        padding: 12px 20px;
        font-size: 16px;
        background: rgba(255, 255, 255, 0.1);
        color: #fff;
        border: 2px solid #fff;
        border-radius: 12px;
        cursor: pointer;
        backdrop-filter: blur(6px);
        transition: all 0.2s ease;
      }
      #clearBtn:hover {
        background: rgba(255, 255, 255, 0.25);
        transform: scale(1.05);
      }
    </style>
  </head>
  <body>
    <svg id="canvas" xmlns="http://www.w3.org/2000/svg">
      <!-- Shared defs for visual effects (glow filter used by glow-ring elements). -->
      <defs>
        <filter
          id="glow"
          x="-75%"
          y="-75%"
          width="250%"
          height="250%"
          color-interpolation-filters="sRGB"
        >
          <!-- Blur then boost the color intensity for a soft halo -->
          <feGaussianBlur stdDeviation="6" result="b" />
          <feColorMatrix
            in="b"
            type="matrix"
            values="1 0 0 0 0
                                0 1 0 0 0
                                0 0 1 0 0
                                0 0 0 0.9 0"
            result="c"
          />
          <feMerge>
            <feMergeNode in="c" />
            <feMergeNode in="SourceGraphic" />
          </feMerge>
        </filter>
      </defs>

      <!-- Group dedicated to rendering glow rings behind the main spinners.
                 Glow rings are kept here so their z-order is consistent. -->
      <g id="glow-layer" aria-hidden="true"></g>
    </svg>
    <button id="clearBtn">Clear</button>

    <script type="module">
      import { init } from './js/app.ts';
      // Mount into the body. If you want a different container, pass a selector or element.
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', () =>
          init(document.body)
        );
      } else {
        init(document.body);
      }
    </script>
  </body>
</html>
